<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Beaver's Bathroom Blitz</title>
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ¦«</text></svg>">
<link rel="stylesheet" href="/src/styles.css">
<link rel="stylesheet" href="/src/UIOverlay.css">
</head>
<body>
<div id="game-container">
  <div id="title-screen" class="screen active">
    <div class="title-card">
      <div class="title-header">
        <div class="title-logo">
          <img src="/images/beaver-logo.png" alt="Beaver Mascot" class="title-beaver-img">
          <h1>Beaver's<br>Bathroom Blitz</h1>
        </div>
        <p class="title-tagline">Cleanest Restrooms in Texas!</p>
        <p class="title-subtitle">Your first day as a Beaver's Travel Stop attendant.<br>Survive 6 shifts to earn the <span class="golden-plunger">ğŸ† Golden Plunger</span>!</p>
        <p class="high-score" id="title-high-score">ğŸ† High Score: <span id="high-score-val">0</span></p>
        <div class="player-rank-display" id="player-rank-display">
          <div class="rank-badge" id="player-rank"><span class="rank-icon">ğŸ§¹</span> Trainee</div>
          <div class="rank-progress-bar"><div class="rank-progress-fill" id="rank-progress-fill"></div></div>
          <div class="rank-xp" id="rank-xp">0 / 500 XP</div>
        </div>
      </div>
      <div class="start-section">
        <div class="gender-toggle">
          <span class="gender-label">Restroom:</span>
          <button class="gender-opt" data-gender="male">ğŸš¹</button>
          <button class="gender-opt selected" data-gender="female">ğŸšº</button>
        </div>
        <button class="btn btn-play" id="start-btn">PLAY</button>
        <button class="btn-help" id="help-btn">How to Play</button>
        <button class="btn-help" id="leaderboard-btn">ğŸ† Leaderboard</button>
        <button class="btn-help" id="achievements-btn">ğŸ–ï¸ Badges</button>
        <button class="btn-help" id="title-settings-btn">âš™ï¸ Settings</button>
      </div>
      <div class="title-footer">
        <a href="https://venmo.com/u/Jeremiah-Daws" target="_blank" rel="noopener" class="tip-link">
          â˜• Support the dev
        </a>
      </div>
    </div>

    <!-- Leaderboard Panel -->
    <div id="leaderboard-panel" class="leaderboard-panel">
      <div class="lb-header">
        <h3>ğŸ† Global Leaderboard</h3>
        <button class="lb-close" id="leaderboard-close">&times;</button>
      </div>
      <div id="leaderboard-list" class="lb-list">
        <div class="lb-empty">Loading...</div>
      </div>
    </div>
  </div>

  <div id="tutorial-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <span class="modal-title">ğŸ¦« How to Play</span>
        <button class="modal-close" id="close-tutorial">&times;</button>
      </div>
      <div class="tutorial-body">
        <div class="tutorial-item"><span class="tutorial-icon">ğŸ‘‹</span><span>You're the new hire! Survive 6 shifts for the Golden Plunger.</span></div>
        <div class="tutorial-item"><span class="tutorial-icon">ğŸš½</span><span>Click dirty stalls, then MASH tasks to clean faster!</span></div>
        <div class="tutorial-item"><span class="tutorial-icon">ğŸš¿</span><span>Scrub those sinks - travelers notice everything!</span></div>
        <div class="tutorial-item"><span class="tutorial-icon">â­</span><span>Keep 5 stars or get fired! Each angry customer hurts your rating.</span></div>
      </div>
      <button class="btn" id="tutorial-got-it">Got it!</button>
    </div>
  </div>

  <div id="settings-modal" class="modal">
    <div class="modal-content settings-content">
      <div class="modal-header">
        <span class="modal-title">âš™ï¸ Settings</span>
        <button class="modal-close" id="close-settings">&times;</button>
      </div>
      <div class="settings-body">
        <div class="setting-row">
          <label class="setting-label"><span class="setting-icon">ğŸ”Š</span> Sound Effects</label>
          <div class="slider-wrap">
            <input type="range" id="sfx-volume" min="0" max="100" value="70" class="volume-slider">
            <span class="volume-val" id="sfx-val">70%</span>
          </div>
        </div>
        <div class="setting-row">
          <label class="setting-label"><span class="setting-icon">ğŸµ</span> Music</label>
          <div class="slider-wrap">
            <input type="range" id="music-volume" min="0" max="100" value="50" class="volume-slider">
            <span class="volume-val" id="music-val">50%</span>
          </div>
        </div>
        <div class="setting-row setting-toggle">
          <label class="setting-label"><span class="setting-icon">ğŸ”‡</span> Mute All</label>
          <button id="master-mute" class="toggle-btn">OFF</button>
        </div>
        <div class="setting-row setting-toggle">
          <label class="setting-label"><span class="setting-icon">ğŸ“³</span> Haptics</label>
          <button id="haptics-toggle" class="toggle-btn active">ON</button>
        </div>
      </div>
    </div>
  </div>

  <div id="achievements-modal" class="modal">
    <div class="modal-content achievements-content">
      <div class="modal-header">
        <span class="modal-title">ğŸ–ï¸ Badges <span id="achievements-count" class="ach-counter">0/0</span></span>
        <button class="modal-close" id="close-achievements">&times;</button>
      </div>
      <div id="achievements-grid" class="achievements-grid"></div>
    </div>
  </div>

  <!-- Daily Reward Modal -->
  <div id="daily-reward-modal" class="modal">
    <div class="modal-content daily-reward-content">
      <div class="dr-header">
        <div class="dr-mascot">ğŸ¦«</div>
        <div class="dr-title">Daily Reward!</div>
      </div>
      <div class="dr-info">
        <div class="dr-day">Day <span id="dr-day-num">1</span></div>
        <div class="dr-streak-row">
          <span class="dr-streak-label">ğŸ”¥ Streak:</span>
          <span id="dr-streak" class="dr-streak-val">1</span>
          <span id="dr-streak-badge" class="dr-streak-badge"></span>
        </div>
      </div>
      <div id="dr-calendar" class="dr-calendar"></div>
      <div class="dr-reward">
        <div class="dr-coins" id="dr-coins">+25 ğŸª™</div>
        <div id="dr-bonus" class="dr-bonus"></div>
      </div>
      <button id="dr-claim-btn" class="btn btn-primary dr-claim">Claim Reward!</button>
    </div>
  </div>

  <!-- Paywall Modal -->
  <div id="paywall-modal" class="modal">
    <div class="modal-content paywall-content">
      <div class="pw-header">
        <div class="pw-mascot">ğŸ¦«</div>
        <div class="pw-title">You're a Natural!</div>
      </div>
      <div class="pw-body">
        <p class="pw-message">You've completed 3 shifts and proven yourself as a bathroom attendant!</p>
        <p class="pw-unlock">Unlock the full game to continue your journey to the <span class="golden-plunger">ğŸ† Golden Plunger</span>!</p>
        <div class="pw-features">
          <div class="pw-feature"><span class="pw-icon">ğŸš½</span> Shifts 4-6 with increasing challenge</div>
          <div class="pw-feature"><span class="pw-icon">ğŸ‘‘</span> VIP customers with 2x rewards</div>
          <div class="pw-feature"><span class="pw-icon">ğŸ›’</span> Supply Shop upgrades</div>
          <div class="pw-feature"><span class="pw-icon">ğŸ</span> Daily login rewards</div>
          <div class="pw-feature"><span class="pw-icon">ğŸ–ï¸</span> Badges & leaderboard</div>
        </div>
      </div>
      <div class="pw-price">
        <span class="pw-amount">$2.99</span>
        <span class="pw-once">one-time purchase</span>
      </div>
      <button id="pw-purchase-btn" class="btn btn-play pw-btn">Unlock Full Game</button>
      <button id="pw-restore-btn" class="btn-help pw-restore">Already purchased? Restore</button>
    </div>
  </div>

  <div id="game-screen" class="screen">
    <div id="hud">
      <div class="hud-item hud-rating"><div class="label">Rating</div><div class="value" id="rating">â­â­â­â­â­</div></div>
      <div class="hud-item hud-score"><div class="label">Score</div><div class="value" id="score">0</div></div>
      <div class="hud-item hud-combo"><div class="label">Combo</div><div class="value" id="combo">x1</div></div>
      <div class="hud-item hud-time"><div class="label">Time</div><div class="value" id="timer">1:00</div></div>
      <button id="settings-btn" aria-label="Settings">âš™ï¸</button>
    </div>
    <!-- Hidden elements for JS compatibility -->
    <div id="dirty-count" style="display:none">0</div>
    <div id="dirty-sinks" style="display:none">0</div>
    <div id="beaver-mascot" class="beaver-idle" style="display:none">
      <div id="beaver-speech" class="beaver-speech"></div>
    </div>
    <div id="play-area">
      <div id="bathroom">
        <div id="stalls-row"></div>
        <div id="floor-area">
          <div id="exit-door">ğŸšª</div>
          <div id="mascot-walk" class="hidden"></div>
          <div id="sink-towel-area">
            <div id="sinks-area"></div>
            <div id="towels"><div>ğŸ“„</div><div>TOWELS</div></div>
          </div>
        </div>
      </div>
      <div id="rush-warning">ğŸšŒ TOUR BUS ARRIVING! ğŸšŒ</div>
      <div id="inspector-warning">ğŸ” HEALTH INSPECTOR! ğŸ”</div>
      <div id="pause-overlay"><span>â¸ï¸ PAUSED</span></div>
      <div id="combo-milestone"></div>
      <div id="combo-break">COMBO LOST!</div>
      <div id="task-panel">
        <h3 id="task-title">Stall #1</h3>
        <div class="hint">Click rapidly to clean faster!</div>
        <div id="task-buttons"></div>
      </div>
    </div>
    <div id="powerups">
      <div class="powerup disabled" id="pow-speed">ğŸ¥©<span class="powerup-text"> Brisket</span> <span class="count" id="cnt-speed">0</span></div>
      <div class="powerup disabled" id="pow-slow">ğŸ§Š<span class="powerup-text"> Icee</span> <span class="count" id="cnt-slow">0</span></div>
      <div class="powerup disabled" id="pow-auto">ğŸ¿<span class="powerup-text"> Nuggets</span> <span class="count" id="cnt-auto">0</span></div>
      <div class="powerup disabled" id="pow-mascot">ğŸ¦«<span class="powerup-text"> Beaver</span> <span class="count" id="cnt-mascot">0</span></div>
    </div>
  </div>

  <div id="result-screen" class="screen">
    <h2 id="result-title">Shift Complete!</h2>
    <div id="result-rating"></div>
    <div class="stats-grid" id="result-stats"></div>
    <div class="grade" id="result-grade">S</div>
    <p id="result-comment"></p>
    <div id="pick-section" style="display:none">
      <p style="font-size:0.75em;opacity:0.7;margin-bottom:8px">You earned:</p>
      <div class="pick-row" id="pick-row"></div>
    </div>
    <div class="share-row">
      <button class="btn btn-share" id="share-result">ğŸ“¤ Share Score</button>
    </div>
    <button class="btn" id="next-btn">Next Shift</button>
  </div>

  <div id="upgrade-screen" class="screen">
    <div class="upgrade-header">
      <h2>ğŸ§¹ Supply Closet</h2>
      <p class="coins-display"><span class="coin-icon">ğŸª™</span> <span id="coins">0</span></p>
    </div>
    <div class="upgrades-grid" id="upgrades-grid"></div>
    <button id="skip-upgrades">Start Next Shift â†’</button>
  </div>

  <div id="gameover-screen" class="screen">
    <div style="font-size:2.5em" id="go-icon">ğŸš½</div>
    <h2 id="go-title">Game Over</h2>
    <p id="go-msg"></p>
    <div style="font-size:2.2em;color:#f5a623" id="go-score">0</div>
    <p class="high-score visible" id="go-high-score" style="margin-top:5px">High Score: <span id="go-high-score-val">0</span></p>
    <div class="stats-grid" id="go-stats"></div>

    <!-- Name input for leaderboard -->
    <div id="go-name-section" class="go-name-section">
      <p>Submit to global leaderboard:</p>
      <div class="go-name-row">
        <input type="text" id="go-name-input" placeholder="Your name" maxlength="20">
        <button class="btn btn-small" id="go-submit-score">Submit</button>
      </div>
    </div>

    <!-- Leaderboard display -->
    <div id="leaderboard-section" class="leaderboard-section" style="display:none">
      <h4>ğŸ† Top Scores</h4>
      <div id="leaderboard-list" class="lb-list"></div>
    </div>

    <!-- Tip jar (shown on win) -->
    <div id="tip-section" class="tip-section" style="display:none">
      <a href="https://venmo.com/u/Jeremiah-Daws" target="_blank" rel="noopener" class="tip-btn">
        ğŸ§ Buy Beaver a Nugget
      </a>
    </div>

    <div class="share-row">
      <button class="btn btn-share" id="share-gameover">ğŸ“¤ Share Score</button>
    </div>
    <button class="btn" id="retry-btn">Try Again</button>
  </div>

  <!-- Share preview modal -->
  <div id="share-modal" class="modal">
    <div class="modal-content share-content">
      <div class="modal-header">
        <span class="modal-title">ğŸ“¤ Share Your Score</span>
        <button class="modal-close" id="close-share">&times;</button>
      </div>
      <div class="share-preview">
        <canvas id="share-canvas" width="540" height="960"></canvas>
      </div>
      <div class="share-actions">
        <button class="btn btn-share-action" id="share-native">ğŸ“± Share</button>
        <button class="btn btn-share-action btn-secondary" id="share-download">ğŸ’¾ Save Image</button>
      </div>
    </div>
  </div>

  <div id="shift-intro" class="screen">
    <div class="intro-card">
      <div class="intro-shift-num" id="intro-shift-num">SHIFT 1</div>
      <h2 class="intro-title" id="intro-title">Training Day</h2>
      <p class="intro-desc" id="intro-desc">Welcome to Beaver's Travel Stop! Time to learn the ropes.</p>
      <div class="beaver-tip">
        <span class="beaver-tip-icon">ğŸ¦«</span>
        <div class="beaver-tip-content">
          <div class="beaver-tip-label">Beaver says...</div>
          <div class="beaver-tip-text" id="intro-tip">Mash those task buttons fast! Speed is everything.</div>
        </div>
      </div>
      <div class="intro-stats">
        <div class="intro-stat"><span class="intro-stat-icon">ğŸš½</span> <span id="intro-stalls">5</span> Stalls</div>
        <div class="intro-stat"><span class="intro-stat-icon">ğŸš¿</span> <span id="intro-sinks">2</span> Sinks</div>
        <div class="intro-stat"><span class="intro-stat-icon">â±ï¸</span> <span id="intro-time">60</span>s</div>
      </div>
      <button class="btn btn-play" id="shift-start-btn">Let's Go!</button>
    </div>
  </div>

  <!-- Speed Clean Challenge Mini-Game -->
  <div id="minigame-intro" class="screen">
    <div class="minigame-card">
      <div class="minigame-badge">âš¡ BONUS ROUND âš¡</div>
      <h2 class="minigame-title">Speed Clean Challenge!</h2>
      <p class="minigame-desc">Clean as many stalls as possible in 30 seconds!</p>
      <div class="minigame-rules">
        <div class="minigame-rule"><span class="rule-icon">ğŸš½</span> Stalls spawn dirty - click to clean!</div>
        <div class="minigame-rule"><span class="rule-icon">âš¡</span> One-click cleaning - no mashing!</div>
        <div class="minigame-rule"><span class="rule-icon">ğŸª™</span> Earn bonus coins for each clean!</div>
      </div>
      <button class="btn btn-play minigame-start-btn" id="minigame-start-btn">GO!</button>
    </div>
  </div>

  <div id="minigame-screen" class="screen">
    <div id="minigame-hud">
      <div class="minigame-hud-item">
        <div class="minigame-label">TIME</div>
        <div class="minigame-value minigame-timer" id="minigame-timer">30</div>
      </div>
      <div class="minigame-hud-item">
        <div class="minigame-label">CLEANED</div>
        <div class="minigame-value minigame-score" id="minigame-cleaned">0</div>
      </div>
    </div>
    <div id="minigame-area">
      <div id="minigame-stalls"></div>
    </div>
  </div>

  <div id="minigame-result" class="screen">
    <div class="minigame-result-card">
      <div class="minigame-result-badge">âš¡ BONUS COMPLETE âš¡</div>
      <h2 class="minigame-result-title">Speed Clean Results!</h2>
      <div class="minigame-result-stats">
        <div class="minigame-stat">
          <div class="minigame-stat-val" id="minigame-final-cleaned">0</div>
          <div class="minigame-stat-lbl">Stalls Cleaned</div>
        </div>
        <div class="minigame-stat">
          <div class="minigame-stat-val" id="minigame-bonus-coins">0</div>
          <div class="minigame-stat-lbl">Bonus Coins</div>
        </div>
      </div>
      <p class="minigame-comment" id="minigame-comment">Great job!</p>
      <button class="btn" id="minigame-continue-btn">Continue â†’</button>
    </div>
  </div>

</div>

<script type="module" src="/src/main.js"></script>
</body>
</html>
